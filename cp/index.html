<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<script src="https://djqizrxa6f10j.cloudfront.net/ecwid-sdk/js/1.2.1/ecwid-app.js"></script>
<link rel="stylesheet" href="https://d35z3p2poghz10.cloudfront.net/ecwid-sdk/css/1.3.8/ecwid-app-ui.css"/>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
<script>
    // Initialize the application
    EcwidApp.init({
      app_id: "add-to-cart-shake-animator-dev",
      autoloadedflag: true,
      autoheight: true
    });

	// Get store info
	let storeData = EcwidApp.getPayload();

	let storeId = storeData.store_id;
	let accessToken = storeData.access_token;
</script>
	<style>
		/*FIX CONFLICT ECWID AND BOOSTTRAP*/
		.fieldset .field__label {
			margin-bottom: 0 !important;
		}

		.fieldset {
			margin-bottom: 1.5em;
		}

		#satc-app {
			width: 100%;
			height: 100vh;
			margin: 0;
			font-family: "HCO Gotham", sans-serif;
			font-size: 15px;
		}

		.satc-field {
			margin-bottom: 1em;
			width: 100%;
		}

		.satc-field span.d-block {
			margin-bottom: 0.5em;
		}

		.satc-field .radio-label {
			padding-top: 0;
			padding-bottom: 0;
		}

		.satc-field label.checkbox > div::before,
		.satc-field label.checkbox > div::after {
			max-width: fit-content;
		}

		.satc-custom-toggle-btn span {
			margin: auto 0;
		}

		.satc-custom-toggle-btn label {
			margin-bottom: 0;
			margin-left: 20px;
		}

		.satc-preview-panel {
			flex: 1;
			text-align: center;
			margin-top:  50px;
		}
		.satc-setting-panel {
			height: 100%;
			width: 350px;
			padding: 1em 2em;
			box-shadow: 6px 0px 10px 0px #e6e6e6;
		}

		.satc-setting-panel .satc-setting--title {
			margin: 0 0 1em 0;
		}
		.satc-setting-panel .satc-animation-selectbox label {
			display: block;
			margin-bottom: 0.5em;
			font-weight: 600;
		}

		.satc-setting-panel .satc-animation-selectbox select {
			padding: 0.3em 0.5em;
			border-radius: 5px;
			width: 50%;
		}

		.satc-preview-panel > button {
			font-size: 1.3em;
			padding: 0.3em 1em;
			border: 1px solid #c3c3c3;
			border-radius: 5px;
			font-family: inherit;
			color: white;
			background-color: black;
		}

		.satc-btn-group {
			display: flex;
			justify-content: space-around;
			margin-top: 2em;
		}

		.satc-save-btn {
			background-color: #9A2320;
			color: white !important;
		}

		.satc-save-btn::before {
			display: none;
		}

		.satc-animated-btn {
			animation-iteration-count: infinite;
			animation-duration: 1s;
		}

		.satc-animation-deactivated {
			animation: none !important;
		}

		/* Vibrate animation */
		.satc-animate-vibrate--auto, .satc-animate-vibrate:hover{
			animation-name: satc-vibrate;
		}

		@keyframes satc-vibrate {
			0%, 100% { transform: translate(0); }
			20% { transform: translate(-2px,2px); }
			40% { transform: translate(-2px,-2px) }
			60% { transform: translate(2px,2px); }
			80% { transform: translate(2px,-2px); }
		}

		/*@keyframes satc-vibrate2 {*/
		/*    0%, 100% { transform: translate(0); }*/
		/*    20% { transform: translate(2px,-2px); }*/
		/*    40% { transform: translate(2px,2px) }*/
		/*    60% { transform: translate(-2px,2px); }*/
		/*    80% { transform: translate(-2px,-2px); }*/
		/*}*/

		/* Shake animation horizontal */
		.satc-animate-shake-horizontal--auto, .satc-animate-shake-horizontal:hover{
			animation-name: satc-shake-horizontal;
		}

		@keyframes satc-shake-horizontal {
			0%, 100% { transform: translateX(0); }
			10%, 30%, 50%, 70% { transform: translateX(-10px); }
			20%, 40%, 60% { transform: translateX(10px); }
			80% { transform: translateX(8px); }
			90% { transform: translateX(-8px); }
		}

		/* Shake animation vertical */
		.satc-animate-shake-vertical--auto, .satc-animate-shake-vertical:hover{
			animation-name: satc-shake-vertical;
		}

		@keyframes satc-shake-vertical {
			0%, 100% { transform: translateX(0); }
			10%, 30%, 50%, 70% { transform: translateY(-8px); }
			20%, 40%, 60% { transform: translateY(8px); }
			80% { transform: translateY(6.4px); }
			90% { transform: translateY(-6.4px); }
		}

		/* Shake animation left right */
		.satc-animate-shake-lr--auto, .satc-animate-shake-lr:hover{
			animation-name: satc-shake-left-right;
		}

		@keyframes satc-shake-left-right {
			0%, 100% { transform: rotate(0deg); transform-origin: 50% 50%; }
			10%, 90% { transform: rotate(8deg); }
			20%, 40%, 60% { transform: rotate(-10deg); }
			30%, 50%, 70% { transform: rotate(10deg); }
			80% { transform: rotate(-8deg); }
		}

		.d-block {
			display: block !important;
		}

		.animation-deactivated {
			animation: none !important;
		}

	</style>
</head>
<body>
<!-- select success state -->
<div class="row" id="satc-app">
	<div class="satc-setting-panel">
		<h4 class="satc-setting--title">Shaking Add To Cart</h4>
		<div class="satc-field satc-custom-toggle-btn">
			<span>Enable app: </span>
			<label class="checkbox">
				<input id="activate-app" type="checkbox" name="">
				<div data-on="enabled" data-off="disabled"><div></div></div>
			</label>
		</div>
		<div class="satc-field satc-custom-toggle-btn">
			<span class="d-block">Animation trigger:</span>
			<div class="radio">
				<label for="auto-trigger">
					<input type="radio" name="triggerType" value="on" id="auto-trigger" checked="">
					<span class="radio-label">
						<span class="gwt-InlineLabel">Automatic</span>
					</span>
				</label>
			</div>
			<div class="radio">
				<label for="trigger-on-hover">
					<input type="radio" name="triggerType" value="on" id="trigger-on-hover">
					<span class="radio-label">
						<span class="gwt-InlineLabel">On Hover</span>
					</span>
				</label>
			</div>
		</div>
		<div class="satc-field fieldset fieldset--select">
			<div class="field field--medium field--filled">
				<label class="field__label">Animation:</label>
				<select class="field__select" id="animation-type">
					<option value="vibrate" selected>Vibrate</option>
					<option value="shake-vertical">Shake vertical</option>
					<option value="shake-horizontal">Shake horizontal</option>
					<option value="shake-lr" >Shake left right</option>
				</select>
				<div class="field__placeholder">Animation</div>
				<span class="field-state--success"><svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px" viewBox="0 0 26 26"><path d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z"></path></svg></span>
				<span class="field-state--close"><svg xmlns="http://www.w3.org/2000/svg" width="16px" height="16px" viewBox="0 0 16 16"><path d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0 c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73 c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z"></path></svg></span>
				<span class="field__arrow"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26"><path d="M7.85 10l5.02 4.9 5.27-4.9c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-6.45 6.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.66-.65 1.72-.65 2.37.01z"></path></svg></span>
			</div>
		</div>
		<div class="satc-field fieldset">
			<div class="field field--medium">
				<span class="fieldset__svg-icon"></span>
				<label class="field__label">Animation duration (second):</label>
				<input id="animation-duration" type="number" class="field__input" tabindex="4" maxlength="64">
				<div class="field__placeholder">Animation duration (second):</div>
				<span class="field-state--success"><svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px" viewBox="0 0 26 26" focusable="false"><path d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z"></path></svg></span>
				<span class="field-state--close"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve" focusable="false"><path d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z"></path></svg></span>
			</div>
			<div class="field__error" aria-hidden="true" style="display: none;"></div>
		</div>
		<div class="satc-field fieldset">
			<div class="field field--medium">
				<span class="fieldset__svg-icon"></span>
				<label class="field__label">Delay time (second):</label>
				<input id="delay-time" type="number" class="field__input" tabindex="4" maxlength="64">
				<div class="field__placeholder">Delay time (second):</div>
				<span class="field-state--success"><svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px" viewBox="0 0 26 26" focusable="false"><path d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z"></path></svg></span>
				<span class="field-state--close"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve" focusable="false"><path d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z"></path></svg></span>
			</div>
			<div class="field__error" aria-hidden="true" style="display: none;"></div>
		</div>
		<div class="satc-btn-group">
			<button id="save" class="btn satc-save-btn">Save</button>
		</div>
	</div>
	<div class="satc-preview-panel">
		<button id="SATC-PREVIEW" class="satc-button-preview satc-animated-btn">Buy now</button>
	</div>
</div>

<!--<h1><script>document.write(languagePack[lang].title);</script></h1>-->

<!--<p><script>document.write(languagePack[lang].description);</script></p>-->

<script>

// Add hidden text labels for accessibility with translations
// 	document.getElementById('storeUrl').setAttribute('aria-label',languagePack[lang].storeUrl);
// 	document.getElementById('save').setAttribute('aria-label',languagePack[lang].save);
// 	document.getElementById('delay').setAttribute('aria-label',languagePack[lang].delay);
// 	document.getElementById('enabled').setAttribute('aria-label',languagePack[lang].enabled);

</script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
<script src="https://d35z3p2poghz10.cloudfront.net/ecwid-sdk/css/1.3.8/ecwid-app-ui.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script type="application/javascript">
	$(document).ready(function() {
		const isAppActivated = $('#activate-app');
		const animationName = $('#animation-type');
		const delayTime = $('#delay-time');
		const animationDuration = $('#animation-duration');
		const triggerHover = $('#trigger-on-hover');
		const triggerAuto = $('#auto-trigger');
		const previewBtn = $('#SATC-PREVIEW');

		EcwidApp.getAppStorage('public', function(data) {
			let savedSetting = null;

			if (data === null) {
				savedSetting = {
					isEnabled: 'false',
					triggerType: 'auto',
					animation: 'vibrate',
					delayTime: 1,
					animationDuration: 2,
				}
			} else {
				savedSetting = JSON.parse(data);
			}

			if (savedSetting.isEnabled === 'true') {
				isAppActivated.prop( "checked", true );
				applyAnimation();
			} else {
				previewBtn.addClass('animation-deactivated');
			}

			animationName.val(savedSetting.animation);
			delayTime.val(savedSetting.delayTime);
			if (savedSetting.delayTime > 0) {
				delayTime.parent().addClass('field--filled');
			}
			delayTime.addClass('field--filled');

			animationDuration.val(savedSetting.animationDuration);
			if (savedSetting.animationDuration > 0) {
				animationDuration.parent().addClass('field--filled');
			}
			animationDuration.addClass('field--filled');

			appToggle();
			applyAnimation();
			animationDurationChange();
		});

		triggerHover.change(applyAnimation);
		triggerAuto.change(applyAnimation);

		isAppActivated.change(appToggle);
		animationName.change(applyAnimation);
		animationDuration.keyup(animationDurationChange);


		$('#save').on('click', saveSetting);

		function changeAnimation(newAnimationClass) {
			const oldAnimateClass = previewBtn.attr('class').split(' ')[2];
			previewBtn.removeClass(oldAnimateClass);
			previewBtn.addClass(newAnimationClass);
		}

		function applyAnimation() {
			let animationClass = '';
			if (triggerHover.is( ":checked" )) {
				animationClass = 'satc-animate-' + animationName.val();
			} else {
				animationClass = 'satc-animate-' + animationName.val() + '--auto';
			}
			changeAnimation(animationClass);
		}

		function animationDurationChange() {
			previewBtn.css('animation-duration', `${animationDuration.val()}s`);
		}

		function saveSetting() {
			const setting = {
				isEnabled: isAppActivated.is( ":checked" ) ? 'true' : 'false',
				animation: animationName.val(),
				delayTime: delayTime.val(),
				triggerType: triggerHover.is( ":checked" ) ? 'hover' : 'auto',
			};

			const data = JSON.stringify(setting);

			EcwidApp.setAppPublicConfig(data, function() {
				console.log('Set app public config success');
			});
		}

		function appToggle() {
			if (isAppActivated.is( ":checked" )) {
				applyAnimation();
				previewBtn.removeClass('satc-animation-deactivated');
			} else {
				previewBtn.addClass('satc-animation-deactivated');
			}
		}

	});
</script>

</body>
</html>
